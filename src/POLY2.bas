*FX3
IFPAGE<>&E00:PROCr
ONERRORMODE7:REPORT:PRINT" at line ";ERL:END
N%=RND(-TIME):PROCinit
MODE2:VDU23;8202;0;0;0;:HIMEM=&2BFF
REPEAT:REPEAT
PROCoff:PROCscreen:PROCstart:PROCboat:PROCon
IF(lev%MOD2)=1PROCfish ELSE PROCshark
PROCbags:PROCstatus:PROCscore:PROCairbar:TIME=0
REPEAT
PROCdiver:PROCair:IF(lev%MOD2)=1PROCmovefish ELSE PROCmoveshark
PROCmovesealife
UNTIL P%=0 OR L%=0 OR O%<928
IFP%=0 PROCgreat:lev%=lev%+1
UNTIL L%=0 OR O%<928
PROCover
UNTIL0
DEFPROCinit:LOCALa%:FX%=&AB8:FY%=&AC0:FH%=&AC8:FV%=&AD0:F%=&AD8:BX%=&AE0:BY%=&AE8:B%=&AF0:lev%=1
DIMs%(3):FORa%=0TO3:READs%(a%):NEXT
DATA134,133,143,131
ENDPROC
DEFPROCscreen:VDU28,0,4,19,0,17,s%((lev%-1)MOD4),12,26,5
IF(lev%MOD4)=1:PROCcirc(40,980,40,3):PROCmt(864,200,64,2):PROCmt(980,200,64,2):
IF(lev%MOD4)=2:PROCcirc(40,860,40,1):PROCmt(864,180,32,15):PROCmt(980,200,64,15)
IF(lev%MOD4)=3:PROCcirc(100,920,40,7):PROCcirc(120,920,40,15):PROCmt(864,180,32,7):PROCmt(980,200,64,7):
IF(lev%MOD4)=0:PROCcirc(40,860,40,5):PROCmt(864,120,32,1):PROCmt(980,200,64,1)
VDU4,28,0,31,19,27,17,143,12,26,28,0,28,19,27,17,132,12,26,5:FORT%=242TO247:VDU23,T%:FORI%=1TO8:VDURND(255):NEXT,
VDU18,0,3:FORY%=127TO160STEP32:FORX%=0TO1279STEP64:VDU25,4,X%;Y%;RND(6)+241:NEXT,
FORG=0TO9:h=RND(2)+224:VDU18,0,15,25,4,(G*136)+8;224;h,10,8,224,18,0,2,25,4,G*136;224;h,10,8,224:NEXT
FORG=3TO6:VDU18,0,5,25,4,64+(G*136);192;227:NEXT
ENDPROC
DEFPROCoff:VDU4,12:FORZ=0TO15:VDU19,Z,0;0;:NEXT:VDU19,14,7;0;:VDU17,14,31,5,15:PRINT"GET READY!":ENDPROC
DEFPROCon:VDU4,17,128,31,5,15:PRINTSPC(10):FORZ=0TO15:VDU19,Z,Z;0;:NEXT:VDU19,0,4;0;19,15,0;0;19,14,6;0;5
IF(lev%MOD4)=1:VDU19,8,5;0;19,9,3;0;
IF(lev%MOD4)=3:VDU19,8,6;0;19,9,7;0;
ENDPROC
DEFPROCboat:VDU5,18,0,15,25,4,512;920;230,231,232,10,8,8,8,233,234,235,236,18,0,7,25,4,512;924;230,231,232,10,8,8,8,233,234,235,236:ENDPROC
DEFPROCstart:X%=32:Y%=214:Z%=1:PROCdraw(Z%,X%,Y%):BW%=7:BH%=7:V%=2:H%=1:P%=8:L%=8:O%=1224:OD%=200:SF%=1:DF%=1:OXY%=0
IF(lev%MOD2)=1cr%=228:co%=1:ELSE:cr%=229:co%=5
crx%=FNgrx:VDU5,18,3,co%,25,4,crx%;192;cr%:ENDPROC
DEFPROCmovesealife:ocx%=crx%:crx%=crx%+6:IFcrx%>1260crx%=0
IFcrx%<>ocx%:VDU5,18,3,co%,25,4,ocx%;192;cr%,25,4,crx%;192;cr%
ENDPROC
DEFPROCshark
SX%=FNrx(4):SY%=FNry:SD%=4:IFSX%<X% SD%=5
PROCdraw(SD%,SX%,SY%):ENDPROC
DEFPROCfish:FORA=0TO7:FX%?A=FNrx(1):FY%?A=FNry:FH%?A=3:F%?A=3
IFA>3:FH%?A=1:F%?A=2
FV%?A=8:PROCdraw(F%?A,FX%?A,FY%?A):NEXT
E%=0:f%=-4:ENDPROC
DEFPROCbags:VDU23,251
IF(lev%MOD4)=1:VDU8,24,56,126,255,62,28,8
IF(lev%MOD4)=2:VDU120,252,255,255,255,252,120,0
IF(lev%MOD4)=3:VDU102,153,153,126,126,153,153,102
IF(lev%MOD4)=0:VDU66,66,126,126,126,126,126,126
FORA=0TO7:BX%?A=(A+1)*16:BY%?A=((RND(153)-1)+48):VDU18,3,7,25,4,BX%?A*8;BY%?A*4;251:NEXT:ENDPROC
DEFPROCairbar:VDU5,18,0,14:MOVE920,40:MOVE1216,40:PLOT85,920,52:PLOT85,1216,52:ENDPROC
DEFPROCair:IFTIME<OD%ENDPROC
O%=O%-(8*DF%):SOUND0,4,6,3
IFO%>912 VDU18,0,15,25,4,O%;52;25,5,O%;40;25,4,O%+8;52;25,5,O%+8;40;
IFO%<1000 VDU19,14,9;0; ELSE VDU19,14,6;0; 
TIME=0:ENDPROC
DEFPROCmoveshark
OSX%=SX%:OSY%=SY%:OSD%=SD%
IFSX%<X%ANDSX%<62:SX%=SX%+SF%:SD%=5
IFSX%>X%ANDSX%>1:SX%=SX%-SF%:SD%=4
IFSY%<Y%ANDSY%<200:SY%=SY%+SF%
IFSY%>Y%ANDSY%>64:SY%=SY%-SF%
IFSX%<>OSX% OR SY%<>OSY% PROCdraw(OSD%,OSX%,OSY%):PROCdraw(SD%,SX%,SY%)
IFSD%=4:safe%=SX%<X% OR SY%>Y% OR SX%>(X%+12) OR SY%<(Y%-16):ELSE:safe%=(SX%+12)<X% OR SY%>Y% OR (SX%+12)>(X%+12) OR SY%<(Y%-16)
IFNOTsafe%PROChurt
ENDPROC
DEFPROCmovefish
IF FH%?E%=2 AND FY%?E%=0:E%=(E%+1) MOD 8:ENDPROC
PROCdraw(F%?E%,FX%?E%,FY%?E%):FX%?E%=FX%?E%+FH%?E%-2:FY%?E%=FY%?E%+FV%?E%-6
IFFX%?E%<4:FH%?E%=3:F%?E%=3
IFFX%?E%>75:FH%?E%=1:F%?E%=2
IFFY%?E%<64ANDFH%?E%<>2 THEN FV%?E%=8 ELSE IF FY%?E%<48 AND FH%?E%=2 THEN FY%?E%=48
IFFY%?E%>200ANDFH%?E%<>2:FV%?E%=4
PROCdraw(F%?E%,FX%?E%,FY%?E%)
IFFH%?E%<>0PROCfishcheck((FX%?E%+3*(F%?E%-2))*2,FY%?E%-5,E%)
E%=(E%+1)MOD8:ENDPROC
DEFPROCfishcheck(X%,Y%,E%):C%=FNrc(X%,Y%)
IFC%<8:PROCdeadfish(E%,C%)
ENDPROC
DEFPROCdeadfish(E%,C%)
P%=P%-1:L%=L%-1:SOUND0,-10,50,10:PROCdraw(F%?E%,FX%?E%,FY%?E%):F%?E%=F%?E%+4:PROCdraw(F%?E%,FX%?E%,FY%?E%)
FH%?E%=2:FV%?E%=0:PROCstatus:VDU18,3,7,25,4,BX%?C%*8;BY%?C%*4;251:BX%?C%=255:BY%?C%=255:ENDPROC
DEFPROCdiver:A%=X%:B%=Y%:C%=Z%
IFINKEY-67ANDX%<66:X%=X%+DF%:Z%=1
IFINKEY-98ANDX%>1:X%=X%-DF%:Z%=0
IFINKEY-73ANDY%<212:Y%=Y%+(DF%*2)
IFINKEY-105ANDY%>54:Y%=Y%-(DF%*2)
IFINKEY-74AND(X%<>A% OR Y%<>B%):DF%=2:OD%=100:PROCair:ELSE:DF%=1:OD%=200
PROCdraw(C%,A%,B%):PROCdraw(Z%,X%,Y%):CX%=X%+6:CY%=Y%-14:PROCcheck(CX%*2,CY%)
IFFNrs(CX%,CY%)=12 ORFNrs(CX%+1,CY%)=12 ORFNrs(CX%+2,CY%)=12 ORFNrs(CX%+3,CY%)=12 OD%=50:SF%=2:PROChurt ELSEOD%=200
IFX%>30 ANDX%<50 ANDY%>211 ANDO%<1068 AND OXY%=0:PROCgotair
IFINKEY-56VDU4,31,7,29,17,143,17,7:PRINT"Paused":REPEATUNTILINKEY-54:VDU17,143,31,7,29:PRINTSPC6:VDU5
IFINKEY-17VDU4,31,5,31,17,143,17,7:PRINT;"Quiet Mode";:VDU5:*FX210,1
IFINKEY-82VDU4,31,5,31,17,143,17,7:PRINT;SPC10;:VDU5:*FX210,0
ENDPROC
DEFPROCcheck(X%,Y%):C%=FNrc(X%,Y%)
IFC%<8:P%=P%-1:S%=S%+200:SOUND1,1,99,1:VDU18,3,7,25,4,BX%?C%*8;BY%?C%*4;251,4:BX%?C%=255:BY%?C%=255:PRINTTAB(13-LENSTR$S%,0);S%
PROCstatus:ENDPROC
DEFPROCgotair:O%=1224:SOUND&12,2,150,8:PROCairbar:OXY%=1:ENDPROC
DEFPROChurt:OD%=50:PROCair:SF%=2:SOUND1,-5,255,1:VDU18,3,1:FORz=1TO4:PLOT69,(X%*16)+RND(64),(Y%*4)+RND(64):NEXT:ENDPROC
DEFPROCstatus:VDU26,4,17,143,17,7,31,1,30,251,32,17,7:PRINT;P%
VDU31,6,30,17,6,241,32,17,7:PRINT;L%:VDU31,11,30:PRINT"Air":VDU17,128,5:ENDPROC
DEFPROCscore:VDU4,17,7,31,6,0:PRINT"$"STRING$(6-LENSTR$S%,"0");S%;:VDU5:ENDPROC
DEFPROCgreat:VDU4,31,5,2:PRINT"NICE ONE!":TIME=0:REPEATUNTILTIME>300:TIME=0:VDU5:ENDPROC
DEFPROCover:VDU4,31,7,2:IFP%<L%PRINT"NICE!" ELSE PRINT"POOR!"
VDU31,4,10:PRINT"Hit SPACE to":VDU31,5,12:PRINT"play again"
REPEATUNTILGET=32:lev%=1:ENDPROC
DEFPROCcirc(h%,v%,r%,c%):VDU24,0;864;1279;1023;29,h%;v%;18,0,c%:x%=r%:y%=0:z%=x%/2
REPEAT:VDU25,4,x%;y%;25,5,-x%;y%;25,4,y%;x%;25,5,-y%;x%;25,4,x%;-y%;25,5,-x%;-y%;25,4,y%;-x%;25,5,-y%;-x%;
y%=y%+1:z%=z%-y%
IFz%<0:z%=z%+x%:x%=x%-1
UNTILx%<y%:ENDPROC
DEFPROCmt(X%,LE%,HE%,CO%):VDU29,X%;864;25,4,0;0;
L=LE%/PI:OX%=-32:OY%=0:FORx%=0TOLE%STEP64
y%=40+RND(40)+HE%*SIN(x%/L):VDU18,0,CO%,25,4,x%;y%;25,4,x%;0;:PLOT85,OX%,OY%:PLOT85,OX%,0
VDU18,0,15,25,4,OX%;OY%+4;25,5,x%;y%+4;:OX%=x%:OY%=y%:NEXT
VDU25,5,x%+16;4;18,0,CO%,25,4,OX%;0;25,4,OX%;OY%;:PLOT85,x%+16,0:ENDPROC
DEFPROCdraw(A%,X%,Y%):CALLW%:ENDPROC
DEFFNrx(W):W=W*4:=(RND(73-W)-1)+4
DEFFNry:=(RND(153)-1)+48
DEFFNrc(X%,Y%):CALLQ%:=?&AB2
DEFFNrs(X%,Y%):CALLR%:addr%=!&70 AND &FFFF:=?addr%
DEFFNgrx:=(RND(32)+2)*32
DEFFNgry:=(RND(33)+18)*16
DEFPROCr:*T.
*FX138,0,128
*FX3,2
IFPAGE>&E00:*KEY0FORT%=0TOTOP-PAGE STEP4:T%!&E00=T%!PAGE:N.|MPAGE=&E00|MOLD|MRUN|M
